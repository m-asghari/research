CREATE TABLE PATH1_EDGES (
  "FROM" NUMBER,
  "TO" NUMBER,
  DISTANCE NUMBER,
  MAX_SPEED NUMBER
);
INSERT INTO PATH1_EDGES VALUES (768701, 774344, 1.36762262960347, 65.0);
INSERT INTO PATH1_EDGES VALUES (774344, 718405, .186239838922423, 65.0);
INSERT INTO PATH1_EDGES VALUES (718405, 759858, 1.08633387467841, 65.0);
INSERT INTO PATH1_EDGES VALUES (759858, 759850, 2.31736330631371, 65.0);
INSERT INTO PATH1_EDGES VALUES (759850, 759835, .134411459772799, 65.0);
INSERT INTO PATH1_EDGES VALUES (759835, 759844, .0682600752180784, 65.0);
INSERT INTO PATH1_EDGES VALUES (759844, 759822, .246199761739544, 65.0);
INSERT INTO PATH1_EDGES VALUES (759822, 718393, .384802867268021, 65.0);
INSERT INTO PATH1_EDGES VALUES (718393, 718392, .398874351310286, 65.0);
INSERT INTO PATH1_EDGES VALUES (718392, 759250, .486403244369285, 65.0);
INSERT INTO PATH1_EDGES VALUES (759250, 759228, .237583886480618, 65.0);
INSERT INTO PATH1_EDGES VALUES (759228, 717006, .468505510938518, 65.0);
INSERT INTO PATH1_EDGES VALUES (717006, 717004, .385574822748877, 65.0);
INSERT INTO PATH1_EDGES VALUES (717004, 715996, .1707857666448, 65.0);
INSERT INTO PATH1_EDGES VALUES (715996, 764151, .365500676054535, 65.0);
INSERT INTO PATH1_EDGES VALUES (764151, 717002, .12894220701808, 65.0);
INSERT INTO PATH1_EDGES VALUES (717002, 717614, .666735853506494, 65.0);
INSERT INTO PATH1_EDGES VALUES (717614, 716573, .43393167818359, 65.0);
INSERT INTO PATH1_EDGES VALUES (716573, 717613, .246820389046654, 65.0);
INSERT INTO PATH1_EDGES VALUES (717613, 716571, 1.40762609262698, 65.0);
INSERT INTO PATH1_EDGES VALUES (716571, 761070, .808314709638576, 65.0);
INSERT INTO PATH1_EDGES VALUES (761070, 717612, .203861598354227, 65.0);
INSERT INTO PATH1_EDGES VALUES (717612, 717610, .569188892617461, 65.0);
INSERT INTO PATH1_EDGES VALUES (717610, 717608, .638874815990094, 65.0);
INSERT INTO PATH1_EDGES VALUES (717608, 764101, .600837911800797, 65.0);
INSERT INTO PATH1_EDGES VALUES (764101, 768066, .9996033370422, 65.0);
INSERT INTO PATH1_EDGES VALUES (768066, 717490, .327767993258312, 65.0);
INSERT INTO PATH1_EDGES VALUES (717490, 717489, .716480865027025, 65.0);
INSERT INTO PATH1_EDGES VALUES (717489, 717488, .329511815861813, 65.0);
INSERT INTO PATH1_EDGES VALUES (717488, 764766, .405868179878944, 65.0);
INSERT INTO PATH1_EDGES VALUES (764766, 717486, .398917240473924, 65.0);
INSERT INTO PATH1_EDGES VALUES (717486, 769405, .300189720913251, 65.0);
INSERT INTO PATH1_EDGES VALUES (769405, 769403, .500770712443849, 65.0);
INSERT INTO PATH1_EDGES VALUES (769403, 717484, .192300293567168, 65.0);
INSERT INTO PATH1_EDGES VALUES (717484, 769388, .582245545186986, 65.0);
INSERT INTO PATH1_EDGES VALUES (769388, 717481, .444462304009017, 65.0);
INSERT INTO PATH1_EDGES VALUES (717481, 717479, .321600213165882, 65.0);
INSERT INTO PATH1_EDGES VALUES (717479, 769373, .349678520638241, 65.0);
INSERT INTO PATH1_EDGES VALUES (769373, 717472, .17127610598017, 65.0);
INSERT INTO PATH1_EDGES VALUES (717472, 717468, .269783756818871, 65.0);
INSERT INTO PATH1_EDGES VALUES (717468, 717466, .354476047175633, 65.0);
INSERT INTO PATH1_EDGES VALUES (717466, 717462, .308454262650932, 65.0);
INSERT INTO PATH1_EDGES VALUES (717462, 717461, .389438833140768, 65.0);
INSERT INTO PATH1_EDGES VALUES (717461, 717458, .313754214370299, 65.0);
INSERT INTO PATH1_EDGES VALUES (717458, 716339, .630038306061108, 65.0);
INSERT INTO PATH1_EDGES VALUES (716339, 717453, .411649844028356, 65.0);
INSERT INTO PATH1_EDGES VALUES (717453, 717450, .442929675421101, 65.0);
INSERT INTO PATH1_EDGES VALUES (717450, 717446, .512260179960952, 65.0);
INSERT INTO PATH1_EDGES VALUES (717446, 716331, .208940681726027, 65.0);
INSERT INTO PATH1_EDGES VALUES (716331, 716328, .541534094477119, 65.0);
INSERT INTO PATH1_EDGES VALUES (716328, 764853, .219172069985655, 65.0);
INSERT INTO PATH1_EDGES VALUES (764853, 718173, .617894382606621, 65.0);
INSERT INTO PATH1_EDGES VALUES (718173, 760643, .798857244188759, 65.0);
INSERT INTO PATH1_EDGES VALUES (760643, 760635, .339568556963253, 65.0);
INSERT INTO PATH1_EDGES VALUES (760635, 774671, .301802282356639, 65.0);
INSERT INTO PATH1_EDGES VALUES (774671, 718166, .351829274876773, 65.0);
INSERT INTO PATH1_EDGES VALUES (718166, 764037, .633851085472667, 65.0);
CREATE TABLE PATH1_SPEED_PATTERNS AS
SELECT *
FROM SPEED_PATTERNS_2013 T1
WHERE T1.LINK_ID IN (SELECT LINK_ID FROM PATH1_SENSORS);
CREATE INDEX PATH1_SPEED_PATTERNS_TIME_IDX ON PATH1_SPEED_PATTERNS(TIME);
CREATE INDEX PATH1_SPEED_PATTERNS_LINK_IDX ON PATH1_SPEED_PATTERNS(LINK_ID);
COMMIT;
CREATE TABLE TEMP AS
SELECT T1."FROM", T1."TO", T2.TIME FROM_TIME, T3.TIME TO_TIME, T2.SPEED FROM_SPEED, T3.SPEED TO_SPEED, T1.DISTANCE, T1.MAX_SPEED
FROM PATH1_EDGES T1, (PATH1_SPEED_PATTERNS T2 FULL OUTER JOIN PATH1_SPEED_PATTERNS T3 ON T2.TIME = T3.TIME)
WHERE T1."FROM" = T2.LINK_ID AND T1."TO" = T3.LINK_ID;
UPDATE TEMP SET FROM_TIME = TO_TIME, FROM_SPEED = TO_SPEED WHERE FROM_TIME = NULL;
UPDATE TEMP SET TO_TIME = FROM_TIME, TO_SPEED = FROM_SPEED WHERE TO_TIME = NULL;
COMMIT;
CREATE TABLE PATH1_EDGE_PATTERNS AS
SELECT "FROM", "TO", FROM_TIME AS TIME, TO_CHAR(FROM_TIME, 'DDD') AS DAY, TO_CHAR(FROM_TIME,'hh24:mi:ss') AS TOD, (DISTANCE*2*3600)/(FROM_SPEED + TO_SPEED) AS TRAVEL_TIME,
CASE WHEN (DISTANCE*2*3600)/(FROM_SPEED + TO_SPEED) > (DISTANCE*100*3600)/(60*MAX_SPEED) THEN 'TRUE' ELSE 'FALSE' END AS CONG 
FROM TEMP;
COMMIT;
CREATE INDEX PATH1_EDGE_PATTERNS_TIME_IDX ON PATH1_EDGE_PATTERNS(TIME);
CREATE INDEX PATH1_EDGE_PATTERNS_TOD_IDX ON PATH1_EDGE_PATTERNS(TOD);
DROP TABLE TEMP;
COMMIT;
